import React, { useEffect, useState, useRef } from 'react';
import '../styles/SplashScreen.css';

interface SplashScreenProps {
  onComplete: () => void;
}

const SplashScreen: React.FC<SplashScreenProps> = ({ onComplete }) => {
  const [fadeOut, setFadeOut] = useState(false);
  const audioRef = useRef<HTMLAudioElement>(null);

  useEffect(() => {
    // Play soft audio when component mounts
    if (audioRef.current) {
      audioRef.current.volume = 0.3; // Set to 30% volume for soft effect
      audioRef.current.play().catch(err => {
        console.log('Audio autoplay was prevented:', err);
        // Many browsers prevent autoplay, so we'll just continue without audio
      });
    }

    // Start fade out after 3.5 seconds
    const timer = setTimeout(() => {
      setFadeOut(true);
      
      // Fade out audio
      if (audioRef.current && !audioRef.current.paused) {
        const fadeAudio = setInterval(() => {
          if (audioRef.current && audioRef.current.volume > 0.01) {
            audioRef.current.volume = Math.max(0, audioRef.current.volume - 0.05);
          } else {
            if (audioRef.current) {
              audioRef.current.pause();
            }
            clearInterval(fadeAudio);
          }
        }, 50);
      }

      // Complete transition after fade animation
      setTimeout(() => {
        onComplete();
      }, 500);
    }, 3500);

    return () => {
      clearTimeout(timer);
      if (audioRef.current) {
        audioRef.current.pause();
      }
    };
  }, [onComplete]);

  return (
    <div className={`splash-screen ${fadeOut ? 'fade-out' : ''}`}>
      <audio ref={audioRef} src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAIAQB8AAIAfAAAEABAAZGF0YQoGAACAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPgCAPg==" />
      
      <div className="splash-content">
        <div className="logo-container">
          <div className="pulse-ring"></div>
          <div className="pulse-ring delay-1"></div>
          <div className="pulse-ring delay-2"></div>
          
          <div className="logo">
            <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
              {/* Heart/Health Symbol */}
              <path 
                d="M60 100C60 100 20 70 20 45C20 32 28 20 40 20C48 20 55 24 60 30C65 24 72 20 80 20C92 20 100 32 100 45C100 70 60 100 60 100Z" 
                fill="#FF6B6B"
                className="heartbeat"
              />
              {/* Plus Symbol */}
              <rect x="52" y="40" width="16" height="40" rx="2" fill="white"/>
              <rect x="40" y="52" width="40" height="16" rx="2" fill="white"/>
            </svg>
          </div>
        </div>

        <div className="text-container">
          <h1 className="app-title slide-up">
            <span className="text-gradient">Afya Quest</span>
          </h1>
          <p className="app-tagline slide-up-delay">
            Empowering Community Health Assistants
          </p>
          <p className="app-subtitle slide-up-delay-2">
            Learn • Grow • Save Lives
          </p>
        </div>

        <div className="loading-bar">
          <div className="loading-progress"></div>
        </div>
      </div>

      <div className="splash-footer">
        <p className="copyright">© 2024 Afya Quest. Making healthcare education accessible.</p>
      </div>
    </div>
  );
};

export default SplashScreen;